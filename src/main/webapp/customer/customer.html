#@layout?()

#define pageinfo()
    <link href="#(ctx)/css/base.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.min.css" rel="stylesheet">
    <title>客户查询</title>
#end

#define main()
#@navshow?()
<div class="container-fluid">
    <div class="row">
        #@leftnav?()
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
            <h1 class="page-header">客户查询</h1>
                    <button class="btn btn-default" data-toggle="modal" data-target="#myModal">增加</button>
                <table data-toggle="table" data-url="#(ctx)/customer/showlist" data-pagination="true" data-search="true" data-show-columns="true"
                       data-height="500" id="tablelist" data-side-pagination="client" data-page-size="5" data-page-number="1"
                       data-show-toggle="true" data-show-pagination-switch="true" 	data-page-list="[5, 10, 50, 100]" data-show-refresh="true">
                    <thead>
                    <tr>
                        <th data-field="Cid">#</th>
                        <th data-field="Cname">名称</th>
                        <th data-field="Carea">区域</th>
                        <th data-field="Clocation">地址</th>
                        <th data-field="Cpeople">负责人</th>
                        <th data-field="Cphone">电话</th>
                        <th data-field="Cemail">电子邮件</th>
                        <th data-field="Cpostcode">邮箱</th>
                        <th data-field="Clevel">等级</th>
                        <th data-field="Username">用户名</th>
                        <th data-field="operation"
                            data-formatter="actionFormatter"
                            data-events="actionEvents">操作</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>
#end

#define js()
    <script src="#(ctx)/js/baseurl.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/locale/bootstrap-table-zh-CN.min.js"></script>
<script>
    function actionFormatter(value, row, index) {
        return '<a class="mod" >修改</a> ' + '<a class="delete">删除</a>';
    }
    //表格  - 操作 - 事件
    window.actionEvents = {
        'click .mod': function(e, value, row, index) {
            window.location.href = "#(ctx)/customer/edit/" + row["Cid"];
        },
        'click .delete' : function(e, value, row, index) {
            $.ajax({
                type: "post",
                data: row,
                url: '#(ctx)/customer/delete',
                success: function (data) {
                    $('#table').bootstrapTable("refresh");
                }
            });
        }
    }
</script>
#end